# =� Bit�cora - 07 Septiembre 2025

## =� Implementaciones Realizadas

### 1. Sistema de Importaciones Relativas para Componentes

**Problema:** Los componentes usaban rutas absolutas largas como `"components/Core/Home/home.css"`

**Soluci�n:** Implementamos sistema como Angular para usar rutas relativas:
```php
// L Antes (ruta absoluta)
protected $CSS_PATHS = ["components/Core/Home/home.css"];

//  Ahora (ruta relativa)
protected $CSS_PATHS = ["./home.css"];
```

**Implementaci�n:**
- Agregado m�todo `resolveRelativePath()` en `CoreComponent`
- Actualizado `css_imports()`, `js_imports()` y `generate_modulesJsWithArg()`
- Soporte para rutas complejas: `"./styles/main.css"`, `"../shared/utils.css"`
- Mantiene compatibilidad total con rutas absolutas

**Beneficios:**
- C�digo m�s limpio y mantenible
- Componentes m�s portables entre carpetas
- Experiencia como Angular/React
- Cero configuraci�n adicional

### 2. Sistema de Decoradores API para Componentes

**Problema:** Se necesitaba una forma elegante de hacer componentes actualizables v�a API sin duplicar l�gica

**Soluci�n:** Sistema de decoradores que reutiliza el m�todo `render()` existente:
```php
#[ApiComponent('/view/inicio', methods: ['GET'])]
class HomeComponent extends CoreComponent {
    // El m�todo render() existente se reutiliza autom�ticamente
}
```

**Implementaci�n:**
- Creado `Core/Attributes/ApiComponent.php` (decorador PHP8)
- Implementado `Core/Services/ApiRouteDiscovery.php` (auto-descubrimiento)
- Integrado en `Routes/Views.php` con `ApiRouteDiscovery::discover()`
- Auto-registro de rutas basado en atributos

**Caracter�sticas:**
- Un solo decorador hace el componente actualizable
- Reutiliza el m�todo `render()` - cero duplicaci�n
- Auto-descubrimiento de componentes con decorador
- Configuraci�n opcional: m�todos HTTP, autenticaci�n

### 3. Actualizaci�n de Arquitectura SPA

**Comprensi�n mejorada:** Lego es una SPA con Window Manager:
- `/` carga `MainComponent` (layout completo)
- `MenuComponent` contiene links como `/view/inicio`
- Window Manager hace `fetch('/view/inicio')` via Ajax
- Componentes se renderizan en `#home-page` como m�dulos
- Misma ruta `/view/inicio` para carga inicial y refresh

## =� Archivos Modificados

### Archivos Core
- `Core/Components/CoreComponent/CoreComponent.php` - M�todo resoluci�n rutas relativas
- `Core/Attributes/ApiComponent.php` - Nuevo decorador
- `Core/Services/ApiRouteDiscovery.php` - Nuevo auto-descubrimiento
- `Routes/Views.php` - Integraci�n auto-descubrimiento API

### Componentes Actualizados
- `components/Core/Home/HomeComponent.php` - Rutas relativas + decorador API

### Documentaci�n
- `docs/COMO_CREAR_COMPONENTES.md` - Completamente actualizada con:
  - Secci�n nueva: Sistema de Importaciones Relativas
  - Secci�n nueva: Componentes con API  
  - Arquitectura SPA clarificada
  - Ejemplos actualizados con rutas relativas
  - Reglas importantes actualizadas

## <� Resultados

### Antes
```php
class MiComponente extends CoreComponent {
    protected $CSS_PATHS = ["components/Core/MiComponente/styles.css"];
    
    protected function component(): string {
        $this->JS_PATHS_WITH_ARG[] = [
            new ScriptCoreDTO("components/Core/MiComponente/script.js", [])
        ];
        return "<div>Contenido</div>";
    }
}
```

### Ahora  
```php
#[ApiComponent('/view/mi-componente', methods: ['GET'])]
class MiComponente extends CoreComponent {
    protected $CSS_PATHS = ["./styles.css"];
    
    protected function component(): string {
        $this->JS_PATHS_WITH_ARG[] = [
            new ScriptCoreDTO("./script.js", [])
        ];
        return "<div>Contenido actualizable</div>";
    }
}
```

## = Mejoras de Experiencia de Desarrollo

1. **Rutas m�s limpias**: `"./archivo.css"` vs `"components/largo/path/archivo.css"`
2. **APIs opcionales**: Solo agregar decorador cuando se necesite
3. **Cero configuraci�n**: Auto-descubrimiento maneja todo
4. **Consistencia**: Misma filosof�a que Angular/React
5. **Reutilizaci�n**: Un m�todo `render()` para todo

## =� Estado Final

-  Sistema de importaciones relativas funcionando
-  Decoradores API implementados y probados
-  HomeComponent actualizado como ejemplo
-  Documentaci�n completamente actualizada
-  Compatibilidad total mantenida
-  Arquitectura SPA clarificada

El framework Lego ahora tiene una experiencia de desarrollo moderna manteniendo su simplicidad y filosof�a original.